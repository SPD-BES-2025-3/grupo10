@startuml Fluxo de Cadastro de Respons치vel

title "Fluxo de Controle - CRUD de Respons치vel"

actor "Usu치rio" as usr
participant "ResponsavelPage" as page
participant "ResponsavelController" as controller
participant "ResponsavelRepository" as repository
database "MongoDB" as db
participant "RedisPublisher" as publisher
queue "Redis" as redis

skinparam sequenceArrowThickness 2
skinparam roundcorner 10

usr -> page: Preenche e envia formul치rio
activate page

page -> controller: POST /api/responsavel
activate controller

controller -> repository: create(dados)
activate repository

repository -> db: save(responsavel)
activate db
db --> repository: responsavelCriado
deactivate db

repository -> publisher: publishOperation("CREATE", responsavelCriado)
activate publisher
publisher -> redis: PUBLISH crud-channel
deactivate publisher

repository --> controller: retorna responsavelCriado
deactivate repository

controller --> page: 201 Created
deactivate controller

page --> usr: Exibe mensagem de sucesso
deactivate page

@enduml
